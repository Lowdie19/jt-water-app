<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Driver Dashboard - Assignments</title>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(to bottom, #b2ebf2, #81d4fa);
  background-attachment: fixed;
  background-repeat: no-repeat;
  background-size: cover;
}

@media (min-width: 1024px) {
  body { padding: 0 30vw; }
}

/* Top Bar */
.top-bar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: white;
  padding: 12px 0;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  z-index: 10;
}

.top-bar h1 {
  font-size: 22px;
  color: #00acc1;
  margin: 0;
  font-weight: bold;#00acc1
}

.body-content {
  margin-top: 80px;
  margin-bottom: 250px;
  padding: 0 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* Assignment Card */
.assign-card {
  background: white;
  border-radius: 14px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  padding: 15px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: transform 0.2s ease, border 0.2s ease;
  border: 4px solid transparent;
}

.assign-card:hover { transform: scale(1.02); }

.assign-info {
  flex: 1;
  word-wrap: break-word;
}
.assign-info b { color: #00acc1; }

.assign-buttons {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.assign-buttons button {
  border: none;
  border-radius: 20px;
  padding: 6px 12px;
  font-weight: 600;
  cursor: pointer;
  transition: 0.2s;
  font-size: 0.9em;
}

.delivered-btn { background: #00d084; color: white; }
.failed-btn { background: #e74c3c; color: white; }
.inactive-btn { background: #ccc !important; color: white; }

/* Bottom Navigation */
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: white;
  border-top: 1px solid #ccc;
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 8px 0;
  box-shadow: 0 -2px 6px rgba(0,0,0,0.1);
}

.bottom-nav button {
  background: none;
  border: none;
  color: #00acc1;
  font-size: 14px;
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  transition: 0.2s;
}

@media (min-width: 768px) {
  .bottom-nav { justify-content: center; gap: 110px; }
}

.bottom-nav button.active { color: #00d084; }
.bottom-nav i { font-size: 20px; margin-bottom: 4px; }

.popup-msg {
  position: fixed;
  bottom: 250px;
  left: 50%;
  transform: translateX(-50%) translateY(30px);
  background: #00d084;
  color: white;
  padding: 10px 20px;
  border-radius: 20px;
  font-size: 14px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.2);
  opacity: 0;
  transition: all 0.4s ease;
  z-index: 999;
}
.popup-msg.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

.address-header {
  font-size: 16px;
  font-weight: bold;
  color: #005f8c;
  margin: 10px 0 5px 0;
  border-top: 1px dashed #005f8c;
  padding-top: 8px;
}
</style>
</head>
<body>

<!-- Top Bar -->
<div class="top-bar">
  <h1>Assign Orders</h1>
</div>

<!-- Assignments List -->
<div class="body-content" id="driverAssignList"></div>

<!-- Bottom Navigation -->
<div class="bottom-nav">
  <button onclick="location.href='driver-dashboard-orders.html'">
    <i class="fa-solid fa-cart-shopping"></i>
    <span>Orders</span>
  </button>
  <button class="active" onclick="location.href='driver-dashboard-assign.html'">
    <i class="fa-solid fa-truck"></i>
    <span>Assign</span>
  </button>
  <button onclick="location.href='driver-dashboard-profile.html'">
    <i class="fa-solid fa-user"></i>
    <span>Profile</span>
  </button>
</div>

<script>
const assignments = [
  { id: 'ORD503', customer: 'Camille Tolentino', address: 'Tawiran St., Brgy. Panashan', items: '3 Rectangular Containers', status: 'PAID' },
  { id: 'ORD504', customer: 'Bea Arcega', address: 'Sampaguita St., Brgy. Panashan', items: '2 Cylindrical Gallons', status: 'COD' },
  { id: 'ORD505', customer: 'Ellaine Pangilinan', address: 'Tawiran St., Brgy. Panashan', items: '1 Rectangular Container', status: 'PAID' }
];

function renderAssignments() {
  const container = document.getElementById('driverAssignList');
  container.innerHTML = '';

  const grouped = {};
  assignments.forEach(a => {
    if (!grouped[a.address]) grouped[a.address] = [];
    grouped[a.address].push(a);
  });

  for (const address in grouped) {
    const header = document.createElement('div');
    header.className = 'address-header';
    header.textContent = address;
    container.appendChild(header);

    grouped[address].forEach(a => {
      const card = document.createElement('div');
      card.className = 'assign-card';
      card.dataset.address = a.address;
      card.dataset.id = a.id;
      card.dataset.status = a._status || 'normal';

      // Apply stored visual state
      if (a._status === 'delivered') {
        card.style.border = '4px solid #00d084';
        card.style.opacity = '0.6';
      } else if (a._status === 'failed') {
        card.style.border = '4px solid #e74c3c';
        card.style.opacity = '1';
      }

      card.innerHTML = `
        <div class="assign-info">
          <b>Order ID:</b> ${a.id}<br>
          <b>Customer:</b> ${a.customer}<br>
          <b>Items:</b> ${a.items}<br>
          <b>Status:</b> <b style="color:black;">${a.status}</b>
        </div>
        <div class="assign-buttons">
          <button class="delivered-btn" onclick="chooseAssign(this, true)">Delivered</button>
          <button class="failed-btn" onclick="chooseAssign(this, false)">Failed</button>
        </div>
      `;
      container.appendChild(card);
    });
  }
}

function chooseAssign(btn, delivered) {
  const card = btn.closest('.assign-card');
  const id = card.dataset.id;
  const assignment = assignments.find(a => a.id === id);

  // Toggle state
  if (delivered) {
    if (assignment._status === 'delivered') {
      assignment._status = 'normal';
      card.style.border = '4px solid transparent';
      card.style.opacity = '1';
    } else {
      assignment._status = 'delivered';
      card.style.border = '4px solid #00d084';
      card.style.opacity = '0.6';
    }
  } else {
    if (assignment._status === 'failed') {
      assignment._status = 'normal';
      card.style.border = '4px solid transparent';
      card.style.opacity = '1';
    } else {
      assignment._status = 'failed';
      card.style.border = '4px solid #e74c3c';
      card.style.opacity = '1';
    }
  }

  card.dataset.status = assignment._status;
}

let counter = 506;
const addresses = ['Tawiran St., Brgy. Panashan', 'Sampaguita St., Brgy. Panashan', 'Azusena St., Brgy. Panashan'];
const customers = ['Kim Liwanag', 'Catlyn Dala', 'Julie Quizon'];
const items = ['2 Rectangular Containers', '1 Cylindrical Gallon', '3 Rectangular Containers'];
const statuses = ['PAID','COD'];

function addRandomAssignment() {
  const assignment = {
    id: `ORD${counter++}`,
    customer: customers[Math.floor(Math.random()*customers.length)],
    address: addresses[Math.floor(Math.random()*addresses.length)],
    items: items[Math.floor(Math.random()*items.length)],
    status: statuses[Math.floor(Math.random()*statuses.length)],
    _status: 'normal'
  };
  assignments.push(assignment);
  renderAssignments();
}

window.onload = () => {
  renderAssignments();
  setInterval(addRandomAssignment, 8000);
};
</script>
<script src="sound.js"></script>
</body>
</html>
