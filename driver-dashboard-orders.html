<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Driver Dashboard - Orders</title>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
/>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(to bottom, #b2ebf2, #81d4fa);
    background-attachment: fixed;
    background-repeat: no-repeat;
    background-size: cover;
  }

  @media (min-width: 1024px) {
    body { padding: 0 30vw; }
  }

  /* Top Bar */
  .top-bar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    padding: 12px 0;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    z-index: 10;
  }

  .top-bar h1 {
    font-size: 22px;
    color: #0097a7;
    margin: 0;
    font-weight: bold;
  }

  .body-content {
    margin-top: 80px;
    margin-bottom: 250px;
    padding: 0 16px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  /* Order Card */
  .order-card {
    background: white;
    border-radius: 14px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    padding: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: transform 0.2s ease, border 0.2s ease;
    border: 4px solid transparent;
  }

  .order-card:hover { transform: scale(1.02); }

  .order-info {
    flex: 1;
    word-wrap: break-word;
  }
  .order-info b { color: #007c91; }

  .order-buttons {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .order-buttons button {
    border: none;
    border-radius: 20px;
    padding: 6px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.2s;
    font-size: 0.9em;
  }

  .delivered-btn { background: #00d084; color: white; }
  .failed-btn { background: #e74c3c; color: white; }
  .inactive-btn { background: #ccc !important; color: white; }

  /* Bottom Navigation */
  .bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    border-top: 1px solid #ccc;
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 8px 0;
    box-shadow: 0 -2px 6px rgba(0,0,0,0.1);
  }

  .bottom-nav button {
    background: none;
    border: none;
    color: #0097a7;
    font-size: 14px;
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    transition: 0.2s;
  }

  @media (min-width: 768px) {
    .bottom-nav { justify-content: center; gap: 110px; }
  }

  .bottom-nav button.active { color: #00d084; }
  .bottom-nav i { font-size: 20px; margin-bottom: 4px; }


.summary-card {
  position: fixed;
  bottom: 70px; /* above bottom nav */
  left: 50%;
  transform: translateX(-50%);
  background: white;
  border-radius: 16px;
  padding: 15px 30px;
  width: 90%;
  max-width: 400px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  text-align: center;
  z-index: 15;
}

.summary-card h3 {
  text-align: center;
  color: #0097a7;
  font-size: 22px;
  margin-top: 0;
}

.summary-row {
  display: flex;
  justify-content: space-between;
  margin: 10px ;
  font-size: 16px;
}
</style>
</head>
<body>

<!-- Top Bar -->
<div class="top-bar">
  <h1>Delivery Orders</h1>
</div>

<!-- Orders List -->
<div class="body-content" id="driverOrdersList">
  <div class="order-card">
    <div class="order-info">
      <span class="order-id" style="font-size:0.85em; font-weight:bold; color:#ccc;">ORD501</span><br><br>
      <b>Customer:</b> Camille Tolentino<br>
      <b>Address:</b> Tawiran St., Brgy. Panashan<br>
      <b>Date:</b> 2025-11-09<br>
      <b>Status:</b> <b style="color: black;">PAID</b><br><br>
      <b>Items:</b><br>3 Rectangular Container<br>
    </div>
    <div class="order-buttons">
      <button class="delivered-btn" onclick="chooseAction(this, true)">Delivered</button>
      <button class="failed-btn" onclick="chooseAction(this, false)">Failed</button>
    </div>
  </div>

  <div class="order-card">
    <div class="order-info">
      <span class="order-id" style="font-size:0.85em; font-weight:bold; color:#ccc;">ORD502</span><br><br>
      <b>Customer:</b> Bea Arcega<br>
      <b>Address:</b> Sampaguita St., Panasahan<br>
      <b>Date:</b> 2025-11-09<br>
      <b>Status:</b> <b style="color: black;">COD</b><br><br>
      <b>Items:</b><br>2 Cylindrical Gallons<br>
    </div>
    <div class="order-buttons">
      <button class="delivered-btn" onclick="chooseAction(this, true)">Delivered</button>
      <button class="failed-btn" onclick="chooseAction(this, false)">Failed</button>
    </div>
  </div>
</div>

<!-- Bottom Navigation -->
<div class="bottom-nav">
  <button class="active" onclick="location.href='driver-dashboard-orders.html'">
    <i class="fa-solid fa-cart-shopping"></i>
    <span>Orders</span>
  </button>
  <button onclick="location.href='driver-dashboard-assign.html'">
    <i class="fa-solid fa-truck"></i>
    <span>Assign</span>
  </button>
  <button onclick="location.href='driver-dashboard-profile.html'">
    <i class="fa-solid fa-user"></i>
    <span>Profile</span>
  </button>
</div>

<!-- Summary Card -->
<div class="summary-card" id="historySummary">
  <h3 style="margin-bottom: 10px; color:#0097a7;">Order Summary</h3>
  <div class="summary-row">
    <span>Total Rectangular:</span>
    <span id="totalRectangular"><b>0</b></span>
  </div>
  <div class="summary-row">
    <span>Total Cylindrical:</span>
    <span id="totalCylindrical"><b>0</b></span>
  </div>
  <div class="summary-row" style="border-top:1px solid #ccc; padding-top:5px; margin-top:5px;">
    <span><b>Total of Orders:</b></span>
    <span id="totalOrders"><b>0</b></span>
  </div>
</div>

<script>
function chooseAction(btn, delivered) {
  const card = btn.closest('.order-card');
  const deliveredBtn = card.querySelector('.delivered-btn');
  const failedBtn = card.querySelector('.failed-btn');
  const orderIdSpan = card.querySelector('.order-id');

  if (delivered) {
    deliveredBtn.classList.add('active-btn');
    failedBtn.classList.remove('active-btn');
    card.dataset.status = 'delivered';
    card.style.border = "4px solid #00d084";
    orderIdSpan.style.color = "#00d084";
    card.style.opacity = "0.6"; // visually mark as done
  } else {
    failedBtn.classList.add('active-btn');
    deliveredBtn.classList.remove('active-btn');
    card.dataset.status = 'failed';
    card.style.border = "4px solid #e74c3c";
    orderIdSpan.style.color = "#e74c3c";
    card.style.opacity = "1";
  }

  updateDriverSummary();
}

function updateDriverSummary() {
  let totalRect = 0;
  let totalCyl = 0;

  document.querySelectorAll(".order-card").forEach(card => {
    const status = card.dataset.status || "new";
    if (status === "delivered") return; // skip delivered orders

    const text = card.innerText.toLowerCase();
    const matchRect = text.match(/(\d+)\s*rectangular/);
    const matchCyl = text.match(/(\d+)\s*cylindrical/);
    if (matchRect) totalRect += parseInt(matchRect[1]);
    if (matchCyl) totalCyl += parseInt(matchCyl[1]);
  });

  document.getElementById("totalRectangular").innerHTML = `<b>${totalRect}</b>`;
  document.getElementById("totalCylindrical").innerHTML = `<b>${totalCyl}</b>`;
  document.getElementById("totalOrders").innerHTML = `<b>${totalRect + totalCyl}</b>`;
}

const names = ["Camille Tolentino", "Bea Arcega", "Kim Liwanag", "Catlyn Dala", "Ellaine Pangilinan", "Julie Quizon"];
const addresses = [
  "Tawiran St., Brgy. Panasahan",
  "Sampaguita St., Brgy. Panasahan",
  "Azusena St., Brgy. Panasahan",
  "Camino St., Brgy. Bagna"
];
const itemTypes = [
  { type: "Rectangular Container", key: "rectangular" },
  { type: "Cylindrical Gallons", key: "cylindrical" }
];

let orderCounter = 503;

// Generate and insert new order card
function addRandomOrder() {
  const name = names[Math.floor(Math.random() * names.length)];
  const address = addresses[Math.floor(Math.random() * addresses.length)];
  const itemType = itemTypes[Math.floor(Math.random() * itemTypes.length)];
  const qty = Math.floor(Math.random() * 3) + 1;
  const status = Math.random() > 0.5 ? "PAID" : "COD";
  const date = new Date().toISOString().split("T")[0];
  orderCounter++;

  const orderHTML = `
    <div class="order-card" data-status="new">
      <div class="order-info">
        <span class="order-id" style="font-size:0.85em; font-weight:bold; color:#ccc;">ORD${orderCounter}</span><br><br>
        <b>Customer:</b> ${name}<br>
        <b>Address:</b> ${address}<br>
        <b>Date:</b> ${date}<br>
        <b>Status:</b> <b style="color: black;">${status}</b><br><br>
        <b>Items:</b><br>${qty} ${itemType.type}<br>
      </div>
      <div class="order-buttons">
        <button class="delivered-btn" onclick="chooseAction(this, true)">Delivered</button>
        <button class="failed-btn" onclick="chooseAction(this, false)">Failed</button>
      </div>
    </div>
  `;

  document.getElementById("driverOrdersList").insertAdjacentHTML("afterbegin", orderHTML);
  updateDriverSummary();
}

// Initial load
window.onload = () => {
  document.getElementById("driverOrdersList").innerHTML = ""; // remove sample cards
  updateDriverSummary();

  // First order after 3 seconds
  setTimeout(() => {
    addRandomOrder();

    // Subsequent orders every 8 seconds
    setInterval(addRandomOrder, 8000);
  }, 3000);
};
</script>
<script src="sound.js"></script>
</body>
</html>
